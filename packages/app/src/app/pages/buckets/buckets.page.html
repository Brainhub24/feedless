<app-page-header> </app-page-header>

<ion-content>
  <div class="ion-margin-horizontal" style="margin-top: 200px">
    <ion-buttons class="ion-float-end">
      <ion-select
        #options
        [formControl]="optionsFormControl"
        interface="popover"
        [hidden]="true"
        (ionChange)="handleBucketActionDebounced($event)"
      >
        <ion-select-option value="import">Import</ion-select-option>
        <ion-select-option value="export">Export</ion-select-option>
      </ion-select>
      <ion-button (click)="options.open($event)">
        Actions
        <ion-icon name="ellipsis-vertical-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
    <div style="align-self: center">
      <h1 style="display: inline-block">Buckets</h1>
    </div>
  </div>

  <app-filter-toolbar [filters]="filters" (appFilterChange)="firstPage($event)">
    <ion-buttons slot="start">
      <ion-item>
        <ion-checkbox
          color="success"
          (ionChange)="toggleCheckAll($event)"
        ></ion-checkbox>
      </ion-item>

      <ion-button
        *ngIf="checkedEntities.length > 0"
        (click)="showActions()"
        color="success"
        fill="solid"
      >
        Actions for {{checkedEntities.length}}
      </ion-button>
    </ion-buttons>
    <ion-button color="primary" fill="solid" (click)="showCreateBucketModal()">
      <ion-icon name="add-outline" slot="start"></ion-icon>
      Bucket
    </ion-button>
  </app-filter-toolbar>

  <!--  <ion-list class="grid">-->
  <ion-list>
    <ion-item *ngIf="entities?.length === 0">
      <em>No {{entityName}}s yet</em>
    </ion-item>
    <ion-item *ngFor="let entity of entities" [button]="true">
      <ion-checkbox
        (ionChange)="onCheckChange($event, entity)"
        [checked]="isChecked(entity)"
        color="success"
      ></ion-checkbox>
      <ion-label class="ion-no-margin">
        <ion-item
          [button]="true"
          lines="full"
          [routerLink]="entity.id"
          style="--background: transparent; --background-hover: none"
        >
          <!--          <ion-thumbnail slot="start">-->
          <!--            <img [src]="entity.imageUrl" alt="" />-->
          <!--          </ion-thumbnail>-->
          <ion-label>
            {{ entity.title }}
            <ion-chip>{{ label(entity.visibility) }}</ion-chip>
            <ion-chip color="primary" *ngIf="isOwner(entity)">owner</ion-chip>

            <span class="ion-float-right">
              {{ toDate(entity.createdAt) | date: 'dd. MMM. YYYY' }}
            </span>
            <p>{{entity.description}}</p>
          </ion-label>
        </ion-item>
      </ion-label>
    </ion-item>

    <ion-infinite-scroll
      *ngIf="pagination && !pagination.isLast && entities.length > 9"
      (ionInfinite)="nextPage($event)"
    >
      <ion-infinite-scroll-content></ion-infinite-scroll-content>
    </ion-infinite-scroll>
  </ion-list>
</ion-content>
