<ion-header translucent>
  <ion-toolbar>
    <ion-title>
      <span>Edit Subscription</span>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismissModal()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content fullscreen>
  <ion-list lines="inset">
    <ion-item>
      <ion-label>Name</ion-label>
      <ion-input
        name="name"
        [(ngModel)]="title"
        [placeholder]="titlePlaceholder"
      ></ion-input>
    </ion-item>
    <ion-item>
      <ion-label>Tags</ion-label>
      <ion-input
        name="tags"
        [(ngModel)]="tags"
        placeholder="Space-separated tags"
      ></ion-input>
    </ion-item>
    <ion-item>
      <ion-label [color]="subscription.feed.broken ? 'red' : null">
        Feed
      </ion-label>
      <ion-input
        required="true"
        type="text"
        name="query"
        placeholder="Enter feed url, website or name"
        [(ngModel)]="feedUrl"
      ></ion-input>
      <ion-button
        (click)="changeFeedUrl(feedUrl)"
        color="danger"
        *ngIf="subscription.feed.broken"
        >Fix Url</ion-button
      >
    </ion-item>
    <ion-item>
      <ion-card>
        <ion-item>
          <app-bubble
            slot="start"
            [color]="subscription.feed.broken ? 'red' : 'green'"
          ></app-bubble>
          <ion-label>
            <p>Feed</p>
            <h3>{{ subscription.feed.title }}</h3>
            <p>
              <a
                [href]="subscription.feed.home_page_url"
                target="_blank"
                referrerpolicy="no-referrer"
                >{{ subscription.feed.home_page_url }}</a
              >
            </p>
            <p>{{ subscription.feed.description }}</p>
            <ion-button
              size="small"
              color="light"
              (click)="showFeedDetails(subscription.feed)"
            >
              Details
            </ion-button>
            <ion-button
              slot="end"
              (click)="changeFeedUrl(feedUrl)"
              *ngIf="!subscription.feed.broken"
              color="light"
              >Change</ion-button
            >
          </ion-label>
        </ion-item>
      </ion-card>
    </ion-item>
  </ion-list>
</ion-content>
<ion-footer>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="unsubscribe()" color="danger"
        >Unsubscribe</ion-button
      >
      <ion-button (click)="dismissModal()">Disable</ion-button>
    </ion-buttons>
    <ion-buttons slot="end">
      <ion-button
        (click)="updateSubscription(); dismissModal()"
        color="primary"
      >
        Save Changes
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-footer>
