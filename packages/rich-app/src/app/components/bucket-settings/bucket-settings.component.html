<ion-header translucent>
  <ion-toolbar>
    <ion-title>Edit Bucket</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="showHiddenMenu()">
        <ion-icon name="ellipsis-vertical-outline"></ion-icon>
      </ion-button>
      <ion-button
        color="primary"
        fill="solid"
        (click)="save()"
        *ngIf="hasDirectChanges()"
      >
        Save
      </ion-button>
      <ion-button (click)="dismissModal()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content fullscreen>
  <ion-list>
    <ion-item>
      <ion-label
        >Name
        <app-bubble
          *ngIf="bucket.title?.length === 0"
          color="red"
          style="padding-right: 20px"
        ></app-bubble
      ></ion-label>
      <ion-input
        name="name"
        [(ngModel)]="bucket.title"
        placeholder="Enter title"
        maxlength="50"
        required="true"
      ></ion-input>
    </ion-item>
    <ion-item>
      <ion-label>
        <h3>Available to others</h3>
        <p *ngIf="!bucket.listed">Feed is private</p>
        <p *ngIf="bucket.listed">Others can subscribe to this bucket</p>
      </ion-label>
      <ion-checkbox name="listed" [(ngModel)]="bucket.listed"></ion-checkbox>
    </ion-item>
    <ion-item *ngIf="bucket.listed">
      <ion-label
        >Description
        <app-bubble
          *ngIf="bucket.listed && !hasDescription()"
          color="blue"
          style="padding-right: 20px"
        ></app-bubble>
      </ion-label>
      <ion-textarea
        name="description"
        [(ngModel)]="bucket.description"
        placeholder="Describe the content in this bucket"
        maxlength="190"
      ></ion-textarea>
    </ion-item>
    <!--    <ion-item class="ion-margin-bottom">-->
    <!--      <ion-label>URL:</ion-label>-->
    <!--      <ion-input-->
    <!--        readonly="true"-->
    <!--        name="managementUrl"-->
    <!--        [(ngModel)]="managementUrl"-->
    <!--      ></ion-input>-->
    <!--    </ion-item>-->

    <ion-item-divider>
      <ion-label> Related </ion-label>
    </ion-item-divider>

    <!-- SUBSCRIPTIONS --------------------------------------------------------------------------------------------- -->

    <ion-item
      lines="lines"
      href="javascript:void(0)"
      (click)="showSubscriptions()"
      detail="true"
    >
      <ion-icon name="git-merge-outline" slot="start"></ion-icon>
      <ion-label>
        <h3>
          Subscriptions
          <app-bubble
            color="red"
            *ngIf="
              bucket.subscriptions.length === 0 || hasBrokenSubscriptions()
            "
          ></app-bubble>
        </h3>
        <p *ngIf="bucket.subscriptions.length > 0">
          Consuming {{ bucket.subscriptions.length }} sites
        </p>
        <p *ngIf="bucket.subscriptions.length === 0">
          <em>Feeds you are subscribed to</em>
        </p>
      </ion-label>
    </ion-item>

    <!-- FILTERS --------------------------------------------------------------------------------------------------- -->

    <ion-item
      lines="lines"
      href="javascript:void(0)"
      (click)="showFilters()"
      detail="true"
    >
      <ion-icon name="eyedrop-outline" slot="start"></ion-icon>
      <ion-label>
        <h3>Filters</h3>
        <p><em>keep unwanted data out of your stream</em></p>
      </ion-label>
    </ion-item>

    <!-- Throttle -------------------------------------------------------------------------------------------------- -->

    <ion-item
      lines="lines"
      href="javascript:void(0)"
      (click)="showThrottle()"
      detail="true"
    >
      <ion-icon name="hourglass-outline" slot="start"></ion-icon>
      <ion-label>
        <h3>Throttle</h3>
        <p><em>Limit the output of this feed</em></p>
      </ion-label>
    </ion-item>

    <!-- POST PROCESSORS ------------------------------------------------------------------------------------------- -->

    <ion-item
      lines="lines"
      href="javascript:void(0)"
      (click)="addPostProcessor()"
      detail="true"
    >
      <ion-icon name="flask-outline" slot="start"></ion-icon>
      <ion-label>
        <h3>Post Processors</h3>
        <p><em>Refine the data by running post processors</em></p>
      </ion-label>
    </ion-item>

    <!-- WEBHOOKS -------------------------------------------------------------------------------------------------- -->

    <!--    <ion-item-->
    <!--      lines="lines"-->
    <!--      href="javascript:void(0)"-->
    <!--      (click)="showWebhooks()"-->
    <!--      detail="true"-->
    <!--    >-->
    <!--      <ion-label>-->
    <!--        <h3>Webhooks</h3>-->
    <!--        <p>Trigger webhooks on bucket event</p>-->
    <!--      </ion-label>-->
    <!--    </ion-item>-->

    <!-- REST CONROL ----------------------------------------------------------------------------------------------- -->

    <!--    <ion-item-->
    <!--      lines="lines"-->
    <!--      href="javascript:void(0)"-->
    <!--      (click)="showRestControl()"-->
    <!--      detail="true"-->
    <!--    >-->
    <!--      <ion-label>-->
    <!--        <h3>REST Control</h3>-->
    <!--        <p>Operate on the bucket using REST</p>-->
    <!--      </ion-label>-->
    <!--    </ion-item>-->
  </ion-list>
</ion-content>
