<ion-header [translucent]="true">
  <app-toolbar>
    <ion-title>
      Buckets / {{ bucket?.title }}
      <ion-icon name="volume-medium" *ngIf="bucket?.listed"></ion-icon
    ></ion-title>
    <ng-container data-buttons>
      <ion-button (click)="showSettings()">
        Edit
        <app-bubble
          style="padding-right: 20px"
          color="red"
          *ngIf="bucketNeedsAction()"
        ></app-bubble>
      </ion-button>
      <ion-button [href]="getFeedUrl()">
        <ion-icon name="logo-rss"></ion-icon>
      </ion-button>
    </ng-container>
  </app-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-spinner *ngIf="loading"></ion-spinner>
  <ion-item
    *ngIf="!loading && (pages.length === 0 || pages[0].articleRefs.length === 0)"
  >
    <ion-label><em>Empty bucket</em></ion-label>
  </ion-item>

  <ion-list *ngFor="let page of pages">
    <ion-note>#{{ page.page + 1}} </ion-note>
    <app-article
      *ngFor="let articleRef of page.articleRefs"
      [showTags]="showTags"
      [articleRef]="articleRef"
      [article]="articleRef.article"
    ></app-article>
    <!--    <ion-infinite-scroll threshold="100px" (ionInfinite)="loadNextPage($event)">-->
    <!--      <ion-infinite-scroll-content loadingSpinner="bubbles">-->
    <!--      </ion-infinite-scroll-content>-->
    <!--    </ion-infinite-scroll>-->
  </ion-list>
  <ion-item *ngIf="!loading">
    <ion-button
      size="small"
      href="javascript:void(0)"
      (click)="fetchNextPage()"
    >
      <ion-icon name="arrow-down-outline"></ion-icon>
      Load More
    </ion-button>
  </ion-item>
</ion-content>
