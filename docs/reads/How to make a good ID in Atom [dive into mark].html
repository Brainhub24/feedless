<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><script src="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/analytics.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app102.us.archive.org';v.server_ms=1041;archive_analytics.send_pageview({});});</script><script type="text/javascript" src="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/playback.js" charset="utf-8"></script>
<script type="text/javascript" src="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/wombat.js" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://diveintomark.org:80/archives/2004/05/28/howto-atom-id","20080701231200","https://web.archive.org/","web","/_static/",
	      "1214953920");
</script>
<link rel="stylesheet" type="text/css" href="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

<meta charset="utf-8">
<title>How to make a good ID in Atom [dive into mark]</title>
<link rel="alternate" type="application/atom+xml" href="https://web.archive.org/web/20080701231200/http://diveintomark.org/feed/">
<link rel="search" type="application/opensearchdescription+xml" href="https://web.archive.org/web/20080701231200/http://static.diveintomark.org/public/2006/09/opensearch-full.xml" title="dive into mark">
<link rel="shortcut icon" href="https://web.archive.org/web/20080701231200im_/http://diveintomark.org/favicon.ico">
<link rel="prev" href="https://web.archive.org/web/20080701231200/http://diveintomark.org/archives/2004/05/27/howto-atom-linkblog" title="How to make a linkblog in Atom">
<link rel="next" href="https://web.archive.org/web/20080701231200/http://diveintomark.org/archives/2004/05/30/pink-numbers" title="Pink Numbers">
<link rel="up" href="https://web.archive.org/archives#p1504" title="May 2004">
<meta name="description" content="Every Atom entry has a required ID, which is an unchanging, globally unique URI. Here's how to make them.">
<meta name="keywords" content="atom,howto">
<style type="text/css">
html{background:white url(https://web.archive.org/web/20080701231200im_/http://static.diveintomark.org/m.png) no-repeat bottom right;color:black}
body{font:normal medium 'Gill Sans','Gill Sans MT','Nimbus Sans',Verdana,sans-serif;margin:1.75em auto;width:40em;line-height:1.75;word-spacing:0.1em}
a{background:transparent}
a:link{color:blue}
a:visited{color:purple}
h1 a,h2 a,h3 a,#nav a,.punch a{color:inherit !important}
acronym,abbr{border:0;letter-spacing:0.1em;text-transform:lowercase;font-variant:small-caps}
h1,h2,h3,p,ul,ol,#nav{margin:1.75em 0}
h1,h2,h3{font-size:medium}
h1,h2{display:inline}
h1{font-weight:normal}
pre,tt{white-space:pre-wrap;font-size:medium;line-height:2.154}
cite{font-style:normal}
img{border:0}
.framed{border:1px solid}
.cl,#arc th,#arc td,.punch p{list-style:none;margin:0;padding:0}
.cl li{margin-bottom:-1px;border-bottom:1px dotted}
.sig,.tb,.pb,blockquote{font-size:small;line-height:2.154;margin:2.154em 0;padding:0}
blockquote{font-style:oblique;border-left:1px dotted;margin-left:2.154em;padding-left:2.154em}
blockquote p{margin:2.154em 0}
.tb,.pb{margin-top:0;padding:2.154em 0}
.sig,.punch,#arc th{text-align:right}
.f,.c{text-align:center;clear:both}
#comment,#arc{width:100%}
#comment{height:14.6em;margin:0;line-height:2.154}
.me{background:papayawhip;color:black;padding:1.75em 1.75em 0 1.75em;border-top:1px dotted;margin-top:-2px}
.me>p:first-child{margin-top:0}
.punch{float:right;font-size:x-small;margin:0 0 1.75em 1.75em;line-height:1.75}
#nav + .punch + p:first-letter{float:left;color:gainsboro;padding:0.11em 4px 0 0;font:normal 4em/0.68 serif}
#arc th{padding:0 1.75em 0 0;vertical-align:baseline}
#arc{border-collapse:collapse}
</style></head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" style="display: block; direction: ltr;" lang="en">
</div><div id="donato" style="position: relative; width: 100%; height: 0px;">
  <div id="donato-base" style="height: 712px;">
    <iframe id="donato-if" src="How%20to%20make%20a%20good%20ID%20in%20Atom%20[dive%20into%20mark]_files/donate.html" scrolling="no" style="width:100%; height:100%" frameborder="0">
    </iframe>
  </div>
</div><script type="text/javascript">
__wm.bt(625,27,25,2,"web","http://diveintomark.org/archives/2004/05/28/howto-atom-id","20080701231200",1996,"/_static/",["/_static/css/banner-styles.css?v=bsmaklHF","/_static/css/iconochive.css?v=qtvMKcIJ"]);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
<div id="nav"><h1><a accesskey="1" href="https://web.archive.org/web/20080701231200/http://diveintomark.org/">dive into mark</a></h1> ‣
<a href="https://web.archive.org/web/20080701231200/http://diveintomark.org/archives#p1504">May 28, 2004</a> ‣
<h2>How to make a good ID in Atom</h2> (<a href="https://web.archive.org/web/20080701231200/http://diveintomark.org/tag/atom" rel="tag">atom</a>, <a href="https://web.archive.org/web/20080701231200/http://diveintomark.org/tag/howto" rel="tag">howto</a>)</div>
<p>Table of contents:</p>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#nohttp">Why you shouldn’t use your permalink as an Atom ID</a></li>
<li><a href="#nourn">Why you shouldn’t use a URN as an Atom ID</a></li>
<li><a href="#tag">How to construct an Atom ID using <code>tag:</code> URIs</a></li>
<li><a href="#other">Other ways to build valid Atom IDs</a></li>
<li><a href="#multiple">What if the same entry appears in multiple feeds?</a></li>
<li><a href="#summary">Summary</a></li>
</ul>

<h4 id="introduction">Introduction</h4>

<p>Every Atom entry must have a globally unique ID, in the <code>&lt;id&gt;</code>
 element.  This helps aggregators and directories keep track of an 
entry, even if it gets updated.  Some aggregators redisplay changed 
entries; some don’t; some track changes over time.  But before you can 
do any of these things, you need to uniquely identify the entry, and 
that’s what <code>&lt;id&gt;</code> is for.</p>

<p>There are three requirements for an Atom ID:</p>

<ol>
<li>The ID must be a valid URI, as defined by <a href="https://web.archive.org/web/20080701231200/http://www.ietf.org/rfc/rfc2396.txt">RFC 2396</a>.</li>
<li>The ID must be globally unique, across all Atom feeds, everywhere, for all time.  This part is actually easier than it sounds.</li>
<li>The ID must never, ever change.</li>
</ol>

<p>There are several ways to construct an unchanging, globally unique URI, but some are better than others.</p>

<h4 id="nohttp">Why you shouldn’t use your permalink as an Atom ID</h4>

<p>It’s valid to use your permalink URL as your <code>&lt;id&gt;</code>,
 but I discourage it because it can create confusion about which element
 should be treated as the permalink.  Developers who don’t read specs 
will look at your Atom feed, and they see two identical pieces of 
information, and they pick one and use it as the permalink, and some of 
them will pick incorrectly.  Then they go to another feed where the two 
elements are not identical, and they get confused.</p>

<p>In Atom, <code>&lt;link rel="alternate"&gt;</code> is <em>always</em> the permalink of the entry.  <code>&lt;id&gt;</code> is <em>always</em>
 a unique identifier for the entry.  Both are required, but they serve 
different purposes.  An entry ID should never change, even if the 
permalink changes.</p>

<p>“Permalink changes”?  Yes, permalinks are not as permanent as you 
might think.  Here’s an example that happened to me.  My permalink URLs 
were automatically generated from the title of my entry, but then I 
updated an entry and changed the title.  Guess what, the “permanent” 
link just changed!  If you’re clever, you can use an HTTP redirect to 
redirect visitors from the old permalink to the new one (and I did).  
But you can’t redirect an ID.</p>

<p><em>The ID of an Atom entry must never change!</em>  Ideally, you 
should generate the ID of an entry once, and store it somewhere.  If 
you’re auto-generating it time after time from data that changes over 
time, then the entry’s ID will change, which defeats the purpose.</p>

<h4 id="nourn">Why you shouldn’t use a URN as an Atom ID</h4>

<p><a href="https://web.archive.org/web/20080701231200/http://www.ietf.org/rfc/rfc2141.txt">RFC 2141</a>
 defines a syntax for URNs.  URNs specifically designed to be used as 
globally unique identifiers.  They are valid URIs.  They look sort of 
like URLs you might type in a browser, but URNs are not designed to be 
clickable.  They’re just structured identifiers.</p>

<p>So why not use them?  Well, the main reason is that they require registration (described in <a href="https://web.archive.org/web/20080701231200/http://www.ietf.org/rfc/rfc3406.txt">RFC 3406</a>).  You can’t just use the domain name you’ve already registered; URN namespace registration is a separate process.</p>

<p>If you have a registered URN namespace, you can use it to generate 
Atom IDs.  But if you haven’t registered one, you can’t just make up a 
URN and publish it.  URNs don’t work that way.</p>

<h4 id="tag">How to construct an Atom ID using <code>tag:</code> URIs</h4>

<p>However, there is an emerging standard that allows anyone to 
construct globally unique identifiers without additional registration: <a href="https://web.archive.org/web/20080701231200/http://www.taguri.org/">tag URIs</a>.
  To construct a tag URI, you only need a domain name or an email 
address.  (A subdomain works too.)  For the purposes of this tutorial, 
I’m going to assume that you have your own domain name or subdomain, and
 that you don’t wish to publish your email address for spammers to 
scrape.</p>

<p>Start with your permalink URL.  I’ll use <code class="codehilite">http://diveintomark.org/archives/2004/05/27/howto-atom-linkblog</code>,
 a real example of a recent post.  Your permalink may look different; it
 may not contain a date; it may just use a numeric ID; it may contain a 
fragment identifier (with a <code>#</code> mark).  That’s OK, you can make a <code>tag:</code> URI out of any URL.</p>

<ol>
<li><p>Discard everything before the domain name.</p>
<p>Progress so far: <code class="codehilite">diveintomark.org/archives/2004/05/27/howto-atom-linkblog</code></p></li>
<li><p>Change all <code>#</code> characters to <code>/</code></p>
<p>Progress so far: unchanged</p></li>
<li><p>Immediately after the domain name, insert a comma, then the 
year-month-day that the article was published, then a colon.  Be sure to
 use a four-digit year, two-digit month, and two-digit day.  Don’t 
forget the colon.</p>
<p>Progress so far: <code class="codehilite">diveintomark.org,2004-05-27:/archives/2004/05/27/howto-atom-linkblog</code></p></li>
<li><p>Add <code>tag:</code> at the beginning.  (Don’t add slashes; it’s just “<code>tag:</code>“.  That’s a common mistake.)</p>
<p>Progress so far: <code class="codehilite">tag:diveintomark.org,2004-05-27:/archives/2004/05/27/howto-atom-linkblog</code></p></li>
</ol>

<p>That’s it!  There are other ways to create valid <code>tag:</code> URIs, but this procedure works for any URL.</p>

<p>The only potential problem here is that if your permalinks may change
 over time (for example, if they are based on title and you modify 
titles after posting, or if you change your permalink URL scheme 
entirely), you must not recompute the <code>tag:</code> URI when the 
permalink changes.  Ideally, you should build the Atom ID once and then 
store it with the rest of the entry data.  If this is not feasible, and 
if you can not guarantee that your permalinks will never change, there 
are some other ways to build valid <code>tag:</code> URIs that you might want to consider instead.</p>

<h4 id="other">Other ways to build valid Atom IDs</h4>

<ul>
<li><p><strong>By some internal key</strong>, such as the primary key on your database’s entry table.  For example, in Movable Type, the <code>&lt;$MTEntryID$&gt;</code> template tag will give you the primary key from the <code>mt_entry</code> table.  This key will never change for a given entry.  It’s not a valid <code>tag:</code> URI all by itself (it’s just a number), but it can be used to construct a valid <code>tag:</code> URI.</p>
<p>Example: <code class="codehilite">tag:diveintomark.org,2004-05-27:1192</code> (the <code>&lt;$MTEntryID$&gt;</code> was 1192)</p>
<p>The only potential problem here is a lack of portability.  I recently
 switched publishing tools, and the import/export routine did not 
capture these database keys.  All of my entry IDs changed.  I am a bad 
person.  This experience was partly what prompted me to write this 
tutorial.</p>
<p>And obviously, if your publishing system does not use a database, then this technique is not for you.  Sorry, Rael.</p>
</li>
<li><p><strong>By entry creation date.</strong>  If your publishing tool
 tracks an unchangeable entry date (that is, a date that doesn’t change 
when the entry is updated, and is not modifiable by the end user), you 
can use it to create a <code>tag:</code> URI.</p>
<p>Example: <code class="codehilite">tag:diveintomark.org,2004-05-27:/archives/20040527110347</code></p>
<p>In this case, the entry creation date was 2004-05-27 at 11:03:47 AM.  Spaces are not allowed in a <code>tag:</code> URI, so I mushed together the year, month, day, hour, minute, and second.</p>
<p>The only potential problem here is that you must guarantee in advance
 that no two entries will be published at exactly the same time, since 
then they would share the same entry ID, which defeats the purpose.  For
 single-author feeds this is generally not a problem, and this is how I 
generate my Atom IDs now.</p>
</li>
</ul>

<h4 id="multiple">What if the same entry appears in multiple feeds?</h4>

<p>If the same entry appears in two different feeds, it must have the 
same ID in both places.  This is not an exception to the “globally 
unique” rule; it’s an integral part of it.  An entry’s ID is the key for
 <em>that entry</em> across all time and space.  If the same entry 
appears in two places, it must have the same ID in both places — 
otherwise it’s not really the same entry.</p>

<p>How could this happen?</p>

<ul>
<li>Category feeds on a site, where an entry appears in multiple categories</li>
<li>Cross-site feeds, like those “Planet XYZ” sites that aggregate content from the sites of several contributors.</li>
</ul>

<p>In the case of multiple feeds produced by the same site, you just 
need to make sure that the way you are constructing your Atom IDs will 
generate the same ID in both places.  Make sure the ID is not based on 
the URL of the feed in which it appears, or the category name, or some 
other data that is different between the feeds in which the entry 
appears.</p>

<p>In the case of sites that aggregate content from multiple sites, the aggregator script should preserve the original <code>&lt;id&gt;</code> element from the entries of each feed.</p>

<p>How aggregators deal with duplicate entries is entirely up to them.  
If an entry appears in two feeds, and you’re subscribed to both feeds, 
some aggregators may display it in both places, but mark it as “read” in
 both feeds once you read it once.  The behavior of client-side software
 is entirely up to the client-side developer.  The only thing <code>&lt;id&gt;</code> does is try to give developers the ability to make those decisions without complicated and error-prone heuristics.</p>

<h4 id="summary">Summary</h4>

<p>An Atom ID is an <strong>unchanging, globally unique URI</strong>.  
All parts of that are important.  If an entry’s ID changes over time, 
that defeats the purpose.  If you’re reusing IDs for different entries, 
that <em>really</em> defeats the purpose.  There are several techniques 
for constructing unchanging, globally unique URIs, and you should use 
whichever one is easiest for you.</p>
<p class="c">§

</p><h3 id="respond">Respond privately</h3>
<p><i>I am no longer accepting public comments on this post, but you can
 use this form to contact me privately.  (Your message will not be 
published.)</i></p>
<form action="https://web.archive.org/web/20080701231200/http://diveintomark.org/public/contact.cgi" method="POST" id="commentform">
<p><label for="author">Name </label><br>
<input type="text" name="author" id="author">
</p><p><label for="email">Email</label><br>
<input type="text" name="email" id="email"></p>
<p><label for="comment">Message</label>
<textarea name="comment" id="comment" rows="10" cols="40"></textarea></p>
<p><input type="submit" value="Send message">
</p>
</form>
<p class="c">§
</p><div class="f">
<p>
<a title="my comments here and elsewhere" href="https://web.archive.org/web/20080701231200/http://firehose.diveintomark.org/">firehose</a> ‧
<a title="my current open source projects" href="https://web.archive.org/web/20080701231200/http://code.google.com/u/pilgrim/">code</a> ‧
<a title="my listening history on last.fm" href="https://web.archive.org/web/20080701231200/http://www.last.fm/user/wearehugh">music</a> ‧
<a title="my personal news aggregator" href="https://web.archive.org/web/20080701231200/http://feeds.diveintomark.org/">planet</a>
</p><p>© 2001-8 <a accesskey="9" href="https://web.archive.org/web/20080701231200/http://diveintomark.org/about">Mark Pilgrim</a>
</p></div>



</body></html>
<!--
     FILE ARCHIVED ON 23:12:00 Jul 01, 2008 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 14:26:28 Dec 14, 2020.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  PetaboxLoader3.resolve: 99.885
  LoadShardBlock: 718.942 (3)
  PetaboxLoader3.datanode: 480.77 (4)
  esindex: 0.017
  exclusion.robots.policy: 0.344
  CDXLines.iter: 19.177 (3)
  captures_list: 758.557
  exclusion.robots: 0.361
  RedisCDXSource: 11.968
  load_resource: 265.003
-->